<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description" content="Reward Penalties on Augmented States for Solving Richly Constrained RL Effectively">
  <meta property="og:title" content="Reward Penalties on Augmented States for Solving Richly Constrained RL Effectively">
  <meta property="og:description" content="Reward Penalties on Augmented States for Solving Richly Constrained RL Effectively">
  <meta property="og:image" content="https://omnimotion.github.io/static/images/open_graph.jpg">
  <meta property="twitter:title" content="Reward Penalties on Augmented States for Solving Richly Constrained RL Effectively">
  <meta property="twitter:description" content="Reward Penalties on Augmented States for Solving Richly Constrained RL Effectively">
  <meta property="twitter:image" content="https://omnimotion.github.io/static/images/open_graph.jpg">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="keywords" content="motion, tracking">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Reward Penalties on Augmented States for Solving Richly Constrained RL Effectively</title>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-D65ZW4CJYF"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-D65ZW4CJYF');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">

  <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> -->
  <script src="./static/js/jquery-3.6.4.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/lazy.js"></script>
  <script src="./static/js/faster.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-2 publication-title">Reward Penalties on Augmented States for Solving Richly Constrained RL Effectively</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              Hao Jiang, </span>
            <span class="author-block">
              <a href="https://computing.smu.edu.sg/faculty/profile/461/mai-anh-tien">Tien Mai, </a></span>
            <span class="author-block">
              <a href="https://computing.smu.edu.sg/faculty/profile/6836/pradeep-reddy-varakantham">Pradeep Varakantham, </a></span>
            <span class="author-block">
              Huy Hoang </span> 
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block">Singapore Management University &nbsp; </span>


          </div>
          <h1 style="font-size:24px">AAAI 2024</h1>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/abs/2301.11592"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/xiaomeijiang258/aaaicrl"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
    .video-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr); /* Three columns */
        grid-template-rows: repeat(2, 1fr); /* Two rows */
        gap: 0px 4px; /* Gap between videos */
        width: 80%; /* Set the container width to 80% */
        margin: 0 auto; /* Center the container horizontally */
    }

    .video-grid video {
        width: 100%; /* Videos fill the container width */
        height: auto;
    }
</style>



<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Constrained Reinforcement Learning employs trajectory-based cost constraints (such as expected cost, Value at Risk, or Conditional VaR cost) to compute safe policies. The challenge lies in handling these constraints effectively while optimizing expected reward. Existing methods convert such trajectory-based constraints into local cost constraints, but they rely on cost estimates, leading to either aggressive or conservative solutions with regards to cost. We propose an unconstrained formulation that employs reward penalties over states augmented with costs to compute safe policies. Unlike standard primal-dual methods, our approach penalizes only infeasible trajectories through state augmentation. This ensures that increasing the penalty parameter always guarantees a feasible policy, a feature lacking in primal-dual methods. Our approach exhibits strong empirical performance and theoretical properties, offering a fresh paradigm for solving complex Constrained RL problems, including rich constraints like expected cost, Value at Risk, and Conditional Value at Risk. Our experimental results demonstrate superior performance compared to leading approaches across various constraint types on multiple benchmark problems.
          </p>
        </div>
      </div>
    </div>
    <br>
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Contribution</h2>
        <div class="content has-text-justified">
          <p>We provide a re-formulation of the constrained RL problem through augmenting the state space with cost accumulated so far and employing reward penalties when cost constraint is violated.
<p>
  We show theoretically the difference between our reward penalties and Lagrangian penalties. We also show that the reward penalties employed in the new formulation are not ad-hoc and can equivalently represent different constraints, i.e. risk-neutral, chance constrained (or VAR) and CVaR constraints.
</p> 
<p>
We modify existing RL methods to solve the re-formulated RL problem with augmented state space and more importantly employing reward penalties when constraints are violated.
</p>
<p>
We demonstrate the utility of our approach by comparing against leading approaches for constrained RL on multiple benchmark problems for different types of constraints. We show that our approaches are able to  outperform leading Constrained RL approaches with different constraints. 
</p>
          </p>
        </div>
      </div>
    </div>
    <br>
    <!--/ Paper video. -->
</section>

<br>

<style>
    .video-grid-two-cols {
        display: grid;
        grid-template-columns: repeat(2, 1fr); /* Two columns */
        gap: 10px; /* Gap between videos */
        width: 60%; /* Set the container width to 60% */
        margin: 0 auto; /* Center the container horizontally */
    }

    .video-grid-two-cols video {
        width: 100%; /* Videos fill the container width */
        height: auto;
    }
</style>

<div class="columns is-centered has-text-centered">
  <h2 class="title is-3"> Results with Risk-Neutral Constraint</h2>
</div>
<div class="container is-max-desktop">
  <div class="columns is-centered has-text-centered">
    <div class="column is-four-fifths">
      <div class="content has-text-justified">
        <p> The experiment environments are Modified GridWorld, <a href="https://github.com/EhsanEI/gym-puddle?tab=readme-ov-file">Puddle</a>, <a href="https://github.com/Farama-Foundation/HighwayEnv">Highway</a> and <a href="https://github.com/openai/safety-gym">Safety Gym</a>. 
        </p>
    </div>
  </div>
</div>
</div>

<section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <div class="carousel-extra-padding">
        <div id="results-carousel" class="carousel results-carousel">
          <div class="item item-swing_tire">
            <video class="carousel-video" id="swing_tire" controls muted loop playsinline height="100%" poster="static/images/swing_tire.jpg" data-src="./static/videos/swing_tire.mp4" type="video/mp4">
            </video>
          </div>
          <div class="item item-tennis">
            <video class="carousel-video" id="tennis" controls muted loop playsinline height="100%" poster="static/images/tennis.jpg" data-src="./static/videos/tennis.mp4" type="video/mp4">
            </video>
          </div>
          <div class="item item-libby">
            <video class="carousel-video" id="libby" controls muted loop playsinline height="100%" poster="static/images/libby.jpg" data-src="./static/videos/libby.mp4" type="video/mp4">
            </video>
          </div>
          <div class="item item-soapbox">
            <video class="carousel-video" id="soapbox" controls muted loop playsinline height="100%" poster="static/images/soapbox.jpg" data-src="./static/videos/soapbox.mp4" type="video/mp4">
            </video>
          </div>
          <div class="item item-snowy-trees">
            <video class="carousel-video" id="snowy-trees" controls muted loop playsinline height="100%" poster="static/images/snowy-trees.jpg" data-src="./static/videos/snowy-trees.mp4" type="video/mp4">
            </video>
          </div>
          <div class="item item-birch">
            <video class="carousel-video" id="birch" controls muted loop playsinline height="100%" poster="static/images/birch.jpg" data-src="./static/videos/birch.mp4" type="video/mp4">
            </video>
          </div>
        </div>
      </div>
    </div>
  <p style="margin-top: 5px; text-align: center; margin-bottom: -15px;">Trail visualization</p>
  </div>
</section>
<br>

<section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <div class="carousel-extra-padding">
        <div id="results-carousel" class="carousel results-carousel">
          <div class="item item-giraffe">
            <video class="carousel-video" id="giraffe" controls muted loop playsinline height="100%" poster="static/images/giraffe.jpg" data-src="./static/videos/giraffe.mp4" type="video/mp4">
            </video>
          </div>
          <div class="item item-india">
            <video class="carousel-video" id="india" controls muted loop playsinline height="100%" poster="static/images/india.jpg" data-src="./static/videos/india.mp4">
            </video>
          </div>
          <div class="item item-longboard">
            <video class="carousel-video" id="longboard" controls muted loop playsinline height="100%" poster="static/images/longboard.jpg" data-src="./static/videos/longboard.mp4">
            </video>
          </div>
          <div class="item item-squirrel">
            <video class="carousel-video" id="squirrel" controls muted loop playsinline height="100%" poster="static/images/squirrel.jpg" data-src="./static/videos/squirrel.mp4">
            </video>
          </div>
          <div class="item item-hike">
            <video class="carousel-video" id="hike" controls muted loop playsinline height="100%" poster="static/images/hike.jpg" data-src="./static/videos/hike.mp4" type="video/mp4">
            </video>
          </div>   
          <div class="item item-flamingo">
            <video class="carousel-video" id="flamingo" controls muted loop playsinline height="100%" poster="static/images/flamingo.jpg" data-src="./static/videos/flamingo.mp4" type="video/mp4">
            </video>
          </div>
          <div class="item item-walking">
            <video class="carousel-video" id="walking" controls muted loop playsinline height="100%" poster="static/images/walking.jpg" data-src="./static/videos/walking.mp4"
                      type="video/mp4">
            </video>
          </div>
        </div>
      </div>
    </div>
  <p style="margin-top: 5px; text-align: center; margin-bottom: -15px;">Point visualization. Points detected as occluded are marked as "+" </p>
  </div>
</section>

<br>
<br>
<br>

<section>
    <div class="columns is-centered has-text-centered">
      <h2 class="title is-3">Abalation Analysis</h2>
       <a id="interactive_demo"></a>
    </div>
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <div class="content has-text-justified">
            <p> To investigate the impact of state augmentation and reward penalty, we conduct an ablation analysis using GridWorld and Highway environments. 
            </p>
        </div>
      </div>
    </div>
  </div>
</section>
<section class="hero">
  <div class="hero-body">
    <div class="">
      <div class="columns is-centered">
        <div class="column is-four-fifths">
          <div class="columns is-centered" style="position: relative;">
            <div class="column is-half image-board">
              <object data="static/SAC_Comparison_Constraint.pdf" height="100%" width="100%"></object>
            <div id="initial-dot"></div>
          <!-- <div class="red-cross"></div> -->
            </div>
            <div class="column is-half image-board move">
              <iframe src="static/SAC_Comparison_Constraint.pdf" width="80%" height="80%"></iframe>
          </div>
          </div>
      </div>
    </div>
    <p style="margin-top: 5px; text-align: center; margin-bottom: -15px;">Ablation Analysis in GridWorld</p>
  </div>
  
  <section class="hero">
    <div class="hero-body">
      <div class="">
        <div class="columns is-centered">
          <div class="column is-four-fifths">
            <div class="columns is-centered" style="position: relative;">
              <div class="column is-half image-board">
                <img style="width: 100%;" class="clickable-image" src="static/demo/swing/00000.jpg" alt="Image">
              <div id="initial-dot"></div>
            <!-- <div class="red-cross"></div> -->
              </div>
              <div class="column is-half image-board move">
                <img style="width: 100%;" class="clickable-image" src="static/demo/swing/00000.jpg" alt="Image">
            </div>
            </div>
        </div>
      </div>
      <p style="margin-top: 5px; text-align: center; margin-bottom: -15px;">Ablation Analysis with Highway</p>
    </div>
</section>

<br>
<br>
<br>



<section>
    <div class="columns is-centered has-text-centered">
      <h2 class="title is-3"> Pseudo-Depth Visualization</h2>
    </div>
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <div class="content has-text-justified">
              <p>Since our method optimizes an underlying quasi-3D representation, we can extract a pseudo-depth visualization showing the relative ordering of different parts of the scene. <font color="blue"><b>Blue</b></font>: near, <font color="red"><b>Red</b></font>: far.</p>
        </div>
      </div>
  </div>
</div>

</section>

<br>
<!-- <br> -->



<section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <div class="carousel-extra-padding">
        <div id="results-carousel" class="carousel results-carousel">
          <div class="item item-lab-coat_pseudo_depth">
            <video class="carousel-video" id="lab-coat_pseudo_depth" controls muted loop playsinline height="100%" poster="static/images/lab-coat_pseudo_depth.jpg" data-src="./static/videos/lab-coat_pseudo_depth.mp4" type="video/mp4">
            </video>
          </div>
          <div class="item item-swing_pseudo_depth">
            <video class="carousel-video" id="swing_pseudo_depth" controls muted loop playsinline height="100%" poster="static/images/swing_pseudo_depth.jpg" data-src="./static/videos/swing_pseudo_depth.mp4" type="video/mp4">
            </video>
          </div>
          <div class="item item-car-roundabout_pseudo_depth">
            <video class="carousel-video" id="car-roundabout_pseudo_depth" controls muted loop playsinline height="100%" poster="static/images/car-roundabout_pseudo_depth.jpg" data-src="./static/videos/car-roundabout_pseudo_depth.mp4" type="video/mp4">
            </video>
          </div>
          <div class="item item-butterfly_pseudo_depth">
            <video class="carousel-video" id="butterfly_pseudo_depth" controls muted loop playsinline height="100%" poster="static/images/butterfly_pseudo_depth.jpg" data-src="./static/videos/butterfly_pseudo_depth.mp4" type="video/mp4">
            </video>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<br>
<br>
<br>


<section>
  <div class="columns is-centered has-text-centered">
    <h2 class="title is-3"> Failure Cases</h2>
  </div>
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <div class="content has-text-justified">
              <p>Like many motion estimation methods, our method struggles with rapid and highly non-rigid motion as well as thin structures. In these scenarios, pairwise correspondence methods can fail to provide enough reliable correspondences for our method to compute accurate global motion. </p>
        </div>
      </div>
  </div>
</div>
  <br>
  <div class="video-grid-two-cols">
      <div>
          <video class="carousel-video" controls muted loop playsinline poster="static/images/bike-packing.jpg" data-src="static/videos/bike-packing.mp4" type="video/mp4">
          </video>
      </div>
      <div>
          <video class="carousel-video" controls muted loop playsinline poster="static/images/dog-agility.jpg" data-src="static/videos/dog-agility.mp4" type="video/mp4">
          </video>
      </div>
  </div>
</section>

<br>

<section class="section" id="Acknowledgements">
  <div class="container is-max-desktop content">
    <h2 class="title is-3">Acknowledgements</h2>
    This research/project is supported by the National Research Foundation Singapore and DSO National Laboratories under the AI Singapore Programme (AISG Award No: AISG2-RP-2020-017)
  </div>
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title is-3">BibTeX</h2>
    <pre><code>Tentatively Unavailable
</code></pre>
  </div>
</section>



<footer class="footer">
  <div align="center" class="container">
    <div class="columns is-centered">
        <div class="content">
            This website is borrowed from <a href="https://github.com/nerfies/nerfies.github.io">nerfies</a>.
        </div>
      </div>
    </div>
</footer>


</body>
</html>
